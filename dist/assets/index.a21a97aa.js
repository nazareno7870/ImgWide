import{j as A,r as n,l as I,M as j,R as F,a as O,u as E,B as G,b as H,c as w,d as D}from"./vendor.5055e729.js";const W=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=t(r);fetch(r.href,l)}};W();const e=A.exports.jsx,g=A.exports.jsxs,N=A.exports.Fragment,R=()=>g("div",{className:"lds-roller",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]});const M=({setmodal:o,modal:a,setimage:t,image:s})=>{const[r,l]=n.exports.useState(!1),c=m=>{console.log(m),(m.target.className==="img-container"||m.target.nodeName==="BUTTON")&&(t(""),l(!1),o(!a))};return g("div",{className:"modal-image",onClick:c,style:{display:a?"block":"none"},children:[e("div",{className:"img-container",style:{display:r?"flex":"none"},children:g("div",{className:"img",children:[e("button",{onClick:c,children:"X"}),e("img",{src:s,onLoad:()=>l(!0)})]})}),r?e(N,{}):e(R,{})]})},L=({ref:o,distance:a="500px"})=>{const[t,s]=n.exports.useState(!1);return n.exports.useEffect(()=>{const r=c=>{c[0].isIntersecting?s(!0):s(!1)};new IntersectionObserver(r,{rootMargin:a}).observe(o.current)},[]),{nextShow:t,setnextShow:s}},z=({page:o})=>{const a="/api/",[t,s]=n.exports.useState([]),r=10,[l,c]=n.exports.useState(null);return n.exports.useEffect(()=>{const m=new AbortController,d=m.signal;return window.fetch(a+`/posts/limit=${r}&skip=${r*(o-1)}`,{signal:d}).then(u=>u.json()).then(u=>s([...t,...u])).catch(u=>{u.name==="AbortError"?console.log("successfully aborted"):c(u)}),()=>m.abort()},[o]),{images:t}},B=()=>{const o="../imgs/posts/",a={default:4,1100:3,700:2,500:1},[t,s]=n.exports.useState(!1),[r,l]=n.exports.useState(""),[c,m]=n.exports.useState(1),d=n.exports.useRef(),{images:u}=z({page:c}),{nextShow:p}=L({ref:d}),b=n.exports.useCallback(I(()=>{m(v=>v+1)},500),[]);n.exports.useEffect(()=>{p&&b()},[p,b]);const S=v=>{l(v.target.currentSrc),s(!t)},C=u.map(function(v){return g("div",{className:"img-item",children:[e("img",{src:o+v.imgSrc,alt:"Image",onClick:S}),e("div",{className:"tags-img",children:v.tags.map(x=>g("p",{children:["#",x," "]},x))})]},v.id)});return g(N,{children:[e(j,{breakpointCols:a,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:C}),e("div",{id:"observe",children:e("p",{ref:d,children:"Whoops... That's it, dude."})}),e(M,{modal:t,setmodal:s,image:r,setimage:l})]})};const $=({settagsBtn:o})=>{const a="/api/",[t,s]=n.exports.useState([]),[r,l]=n.exports.useState(null);return n.exports.useEffect(()=>{const c=new AbortController,m=c.signal;return window.fetch(a+"/tags/all",{signal:m}).then(d=>d.json()).then(d=>{const u=d.map(p=>p.tag);o(u)}).catch(d=>{d.name==="AbortError"?console.log("successfully aborted"):l(d)}),()=>c.abort()},[]),t},_=o=>new Promise(a=>{F.imageFileResizer(o,700,1250,"WEBP",95,0,t=>{a(t)},"file")}),U=()=>{const[o,a]=n.exports.useState([]);$({settagsBtn:a});const[t,s]=n.exports.useState([]),[r,l]=n.exports.useState(null),[c,m]=n.exports.useState(null),[d,u]=n.exports.useState(!1),[p,b]=n.exports.useState(""),S=()=>{s([]),m(null),l(null),u(!1)},C=h=>{const f=h.target.innerHTML;if(t.includes(f)){const y=t.filter(i=>i!==f);s(y)}else s(y=>[...y,f])},v=async h=>{u(!0),h.preventDefault();const y=await _(r),i=new FormData;i.append("file",y),i.append("tags",t),i.append("userId","61e9c0bff06e4fa6550d2760"),i.append("username","Nazareno7870"),O.post({}.VITE_PATH+"/posts/createpost",i).then(P=>{S()})},x=h=>{l(h.target.files[0]);const f=new FileReader;f.readAsDataURL(h.target.files[0]),f.onloadend=y=>{m(f.result)}},T=h=>{if(h.key==="Enter"){const f=p.split(" ");for(let i=0;i<f.length;i++)f[i]=f[i].charAt(0).toUpperCase()+f[i].slice(1);const y=f.join(" ");if(a(i=>[...i,y]),t.includes(y)){const i=t.filter(P=>P!==y);s(i)}else s(i=>[...i,y]);b("")}};return g(N,{children:[e("div",{className:"tags",children:o.map(h=>e("button",{onClick:C,className:t.includes(h)?"active":"",children:h},h))}),e("input",{type:"text",id:"newTag",placeholder:"New Tag",value:p,onKeyPress:T,onChange:h=>b(h.target.value)}),g("form",{className:"form-new-post",onSubmit:v,children:[c!==null?e("img",{className:"new-image",src:c,alt:"imagen a enviar"}):e(N,{}),e("label",{htmlFor:"files",className:"btn",children:"Select Image"}),e("input",{id:"files",type:"file",accept:"image/jpg, image/jpeg",onChange:x}),e("button",{className:"btn-creatpost",children:"Submit"})]}),e("div",{className:"modal-image",style:{display:d?"block":"none"},children:e(R,{})})]})};const K=({showMenu:o,setshowMenu:a})=>{const t=n.exports.useRef(),s=E();return n.exports.useEffect(()=>{o?t.current.style.top="47px":t.current.style.top="-156px"},[o]),e("div",{ref:t,className:"menu",children:g("ul",{children:[e("li",{onClick:()=>{s("/gallery"),a(!t)},children:"Latest"}),e("li",{onClick:()=>{s("/createpost"),a(!t)},children:"Create Post"}),e("li",{onClick:()=>{s("/tag"),a(!t)},children:"Tags"})]})})};const q=()=>{const[o,a]=n.exports.useState(!1),t=E();return g(N,{children:[g("div",{className:"navbar",children:[e("div",{className:"logo",children:e("a",{href:"#",onClick:()=>t("/"),children:e("img",{src:"imgs/assets/logo.svg",alt:"Logo ImgWide"})})}),e("div",{className:"menu-desk",children:g("ul",{children:[e("li",{onClick:()=>{t("/gallery")},children:"Latest"}),e("li",{onClick:()=>{t("/createpost")},children:"Create Post"}),e("li",{onClick:()=>{t("/tag")},children:"Tags"})]})}),e("div",{className:"icon-menu",onClick:()=>a(!o),children:e("img",{src:"imgs/assets/menu-icon.svg",alt:"Menu ImgWide"})})]}),e(K,{showMenu:o,setshowMenu:a})]})},k=({children:o})=>g(N,{children:[e(q,{}),e("div",{className:"container",children:o})]});const V=({page:o,TagRef:a})=>{const t="/api/",[s,r]=n.exports.useState([]),l=10,[c,m]=n.exports.useState(null);return n.exports.useEffect(()=>{const d=new AbortController,u=d.signal;return window.fetch(t+`/tags/tag/${a}&limit=${l}&skip=${l*(o-1)}`,{signal:u}).then(p=>p.json()).then(p=>r([...s,...p])).catch(p=>{p.name==="AbortError"?console.log("successfully aborted"):m(p)}),()=>d.abort()},[o]),{images:s}},X=()=>{const o="../imgs/posts/",a=window.location.pathname.slice(5),t={default:4,1100:3,700:2,500:1},[s,r]=n.exports.useState(!1),[l,c]=n.exports.useState(""),[m,d]=n.exports.useState(1),u=n.exports.useRef(),{images:p}=V({page:m,TagRef:a}),{nextShow:b}=L({ref:u}),S=n.exports.useCallback(I(()=>{d(x=>x+1)},500),[]);n.exports.useEffect(()=>{b&&S()},[b,S]);const C=x=>{c(x.target.currentSrc),r(!s)},v=p.map(function(x){return g("div",{className:"img-item",children:[e("img",{src:o+x.imgSrc,alt:"Image",onClick:C}),e("div",{className:"tags-img",children:x.tags.map(T=>g("p",{children:["#",T," "]},T))})]},x.id)});return g(N,{children:[e(j,{breakpointCols:t,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:v}),e("div",{id:"observe",children:e("p",{ref:u,children:"Whoops... That's it, dude."})}),e(M,{modal:s,setmodal:r,image:l,setimage:c})]})},J=()=>{const[o,a]=n.exports.useState([]);$({settagsBtn:a});const t=E();return e("div",{className:"tags",children:o.map(s=>e("button",{onClick:()=>t(s),children:s},s))})};function Q(){return e(N,{children:e(G,{children:g(H,{children:[e(w,{exact:!0,path:"/gallery",element:e(k,{children:e(B,{})})}),e(w,{exact:!0,path:"/",element:e(k,{children:e(B,{})})}),e(w,{exact:!0,path:"/tag",element:e(k,{children:e(J,{})})}),e(w,{exact:!0,path:"/tag/*",element:e(k,{children:e(X,{})})}),e(w,{exact:!0,path:"/createpost",element:e(k,{children:e(U,{})})})]})})})}D.render(e(Q,{}),document.getElementById("root"));
