import{j as k,r,l as A,M as E,a as $,u as T,B,R as O,b as C,c as G}from"./vendor.c3529adc.js";const H=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const l of t)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function s(t){const l={};return t.integrity&&(l.integrity=t.integrity),t.referrerpolicy&&(l.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?l.credentials="include":t.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(t){if(t.ep)return;t.ep=!0;const l=s(t);fetch(t.href,l)}};H();const e=k.exports.jsx,g=k.exports.jsxs,b=k.exports.Fragment,j=()=>g("div",{className:"lds-roller",children:[e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{}),e("div",{})]});const I=({setmodal:a,modal:o,setimage:s,image:n})=>{const[t,l]=r.exports.useState(!1),c=u=>{console.log(u),(u.target.className==="img-container"||u.target.nodeName==="BUTTON")&&(s(""),l(!1),a(!o))};return g("div",{className:"modal-image",onClick:c,style:{display:o?"block":"none"},children:[e("div",{className:"img-container",style:{display:t?"flex":"none"},children:g("div",{className:"img",children:[e("button",{onClick:c,children:"X"}),e("img",{src:n,onLoad:()=>l(!0)})]})}),t?e(b,{}):e(j,{})]})},P=({ref:a,distance:o="500px"})=>{const[s,n]=r.exports.useState(!1);return r.exports.useEffect(()=>{const t=c=>{c[0].isIntersecting?n(!0):n(!1)};new IntersectionObserver(t,{rootMargin:o}).observe(a.current)},[]),{nextShow:s,setnextShow:n}},W=({page:a})=>{const o="/api",[s,n]=r.exports.useState([]),t=10,[l,c]=r.exports.useState(null);return r.exports.useEffect(()=>{const u=new AbortController,d=u.signal;return window.fetch(o+`/posts/limit=${t}&skip=${t*(a-1)}`,{signal:d}).then(i=>i.json()).then(i=>n([...s,...i])).catch(i=>{i.name==="AbortError"?console.log("successfully aborted"):c(i)}),()=>u.abort()},[a]),{images:s}},M=()=>{const a={default:4,1100:3,700:2,500:1},[o,s]=r.exports.useState(!1),[n,t]=r.exports.useState(""),[l,c]=r.exports.useState(1),u=r.exports.useRef(),{images:d}=W({page:l}),{nextShow:i}=P({ref:u}),m=r.exports.useCallback(A(()=>{c(v=>v+1)},500),[]);r.exports.useEffect(()=>{i&&m()},[i,m]);const N=v=>{t(v.target.currentSrc),s(!o)},S=d.map(function(v){return g("div",{className:"img-item",children:[e("img",{src:v.imgSrc,alt:"Image",onClick:N}),e("div",{className:"tags-img",children:v.tags.map(f=>g("p",{children:["#",f," "]},f))})]},v.id)});return g(b,{children:[e(E,{breakpointCols:a,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:S}),e("div",{id:"observe",children:e("p",{ref:u,children:"Whoops... That's it, dude."})}),e(I,{modal:o,setmodal:s,image:n,setimage:t})]})};const L=({settagsBtn:a})=>{const o="/api",[s,n]=r.exports.useState([]),[t,l]=r.exports.useState(null);return r.exports.useEffect(()=>{const c=new AbortController,u=c.signal;return window.fetch(o+"/tags/all",{signal:u}).then(d=>d.json()).then(d=>{const i=d.map(m=>m.tag);a(i)}).catch(d=>{d.name==="AbortError"?console.log("successfully aborted"):l(d)}),()=>c.abort()},[]),s},F=()=>{const a="/api",[o,s]=r.exports.useState([]);L({settagsBtn:s});const[n,t]=r.exports.useState([]),[l,c]=r.exports.useState(!1),[u,d]=r.exports.useState(""),[i,m]=r.exports.useState(""),N=()=>{t([]),m(""),c(!1)},S=p=>{const x=p.target.innerHTML;if(n.includes(x)){const y=n.filter(h=>h!==x);t(y)}else t(y=>[...y,x])},v=async p=>{c(!0),p.preventDefault();const x={imgurl:i,tags:n,userId:"61e9c0bff06e4fa6550d2760",username:"Nazareno7870"};$.post(a+"/posts/createpost",x).then(y=>{N()})},f=p=>{if(p.key==="Enter"){const x=u.split(" ");for(let h=0;h<x.length;h++)x[h]=x[h].charAt(0).toUpperCase()+x[h].slice(1);const y=x.join(" ");if(s(h=>[...h,y]),n.includes(y)){const h=n.filter(R=>R!==y);t(h)}else t(h=>[...h,y]);d("")}};return g(b,{children:[e("div",{className:"tags",children:o.map(p=>e("button",{onClick:S,className:n.includes(p)?"active":"",children:p},p))}),e("input",{type:"text",id:"newTag",placeholder:"New Tag",value:u,onKeyPress:f,onChange:p=>d(p.target.value)}),g("form",{className:"form-new-post",onSubmit:v,children:[i!==""?e("img",{className:"new-image",src:i,alt:"imagen a enviar"}):e(b,{}),e("input",{type:"text",name:"url",id:"url",value:i,onChange:p=>m(p.target.value)}),e("button",{className:"btn-creatpost",children:"Submit"})]}),e("div",{className:"modal-image",style:{display:l?"block":"none"},children:e(j,{})})]})};const _=({showMenu:a,setshowMenu:o})=>{const s=r.exports.useRef(),n=T();return r.exports.useEffect(()=>{a?s.current.style.top="47px":s.current.style.top="-156px"},[a]),e("div",{ref:s,className:"menu",children:g("ul",{children:[e("li",{onClick:()=>{n("/gallery"),o(!s)},children:"Latest"}),e("li",{onClick:()=>{n("/createpost"),o(!s)},children:"Create Post"}),e("li",{onClick:()=>{n("/tag"),o(!s)},children:"Tags"})]})})};const D=()=>{const[a,o]=r.exports.useState(!1),s=T();return g(b,{children:[g("div",{className:"navbar",children:[e("div",{className:"logo",children:e("a",{href:"#",onClick:()=>s("/"),children:e("img",{src:"imgs/assets/logo.svg",alt:"Logo ImgWide"})})}),e("div",{className:"menu-desk",children:g("ul",{children:[e("li",{onClick:()=>{s("/gallery")},children:"Latest"}),e("li",{onClick:()=>{s("/createpost")},children:"Create Post"}),e("li",{onClick:()=>{s("/tag")},children:"Tags"})]})}),e("div",{className:"icon-menu",onClick:()=>o(!a),children:e("img",{src:"imgs/assets/menu-icon.svg",alt:"Menu ImgWide"})})]}),e(_,{showMenu:a,setshowMenu:o})]})},w=({children:a})=>g(b,{children:[e(D,{}),e("div",{className:"container",children:a})]});const K=({page:a,TagRef:o})=>{const s="/api",[n,t]=r.exports.useState([]),l=10,[c,u]=r.exports.useState(null);return r.exports.useEffect(()=>{const d=new AbortController,i=d.signal;return window.fetch(s+`/tags/tag/${o}&limit=${l}&skip=${l*(a-1)}`,{signal:i}).then(m=>m.json()).then(m=>t([...n,...m])).catch(m=>{m.name==="AbortError"?console.log("successfully aborted"):u(m)}),()=>d.abort()},[a]),{images:n}},U=()=>{const a=window.location.pathname.slice(5),o={default:4,1100:3,700:2,500:1},[s,n]=r.exports.useState(!1),[t,l]=r.exports.useState(""),[c,u]=r.exports.useState(1),d=r.exports.useRef(),{images:i}=K({page:c,TagRef:a}),{nextShow:m}=P({ref:d}),N=r.exports.useCallback(A(()=>{u(f=>f+1)},500),[]);r.exports.useEffect(()=>{m&&N()},[m,N]);const S=f=>{l(f.target.currentSrc),n(!s)},v=i.map(function(f){return g("div",{className:"img-item",children:[e("img",{src:f.imgSrc,alt:"Image",onClick:S}),e("div",{className:"tags-img",children:f.tags.map(p=>g("p",{children:["#",p," "]},p))})]},f.id)});return g(b,{children:[e(E,{breakpointCols:o,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column",children:v}),e("div",{id:"observe",children:e("p",{ref:d,children:"Whoops... That's it, dude."})}),e(I,{modal:s,setmodal:n,image:t,setimage:l})]})},q=()=>{const[a,o]=r.exports.useState([]);L({settagsBtn:o});const s=T();return e("div",{className:"tags",children:a.map(n=>e("button",{onClick:()=>s(n),children:n},n))})};function z(){return e(b,{children:e(B,{children:g(O,{children:[e(C,{exact:!0,path:"/gallery",element:e(w,{children:e(M,{})})}),e(C,{exact:!0,path:"/",element:e(w,{children:e(M,{})})}),e(C,{exact:!0,path:"/tag",element:e(w,{children:e(q,{})})}),e(C,{exact:!0,path:"/tag/*",element:e(w,{children:e(U,{})})}),e(C,{exact:!0,path:"/createpost",element:e(w,{children:e(F,{})})})]})})})}G.render(e(z,{}),document.getElementById("root"));
